<html>
<head>
    <link rel="stylesheet" type="text/css" href="./css/style.css" />

    <script src="./js/jquery.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://static.wowhead.com/widgets/power.js"></script>

    <script type="text/javascript">

        // Colors from http://www.wowwiki.com/Class_colors
        var CLASS_COLORS = {
            'Death Knight': '#C41F3B',
            'Druid':        '#FF7D0A',
            'Hunter':       '#ABD473',
            'Mage':         '#69CCF0',
            'Monk':         '#558A84',
            'Paladin':      '#F58CBA',
            'Priest':       '#E0E0E0', // original is '#FFFFFF', but white on white...
            'Rogue':        '#FFd539', // oritinal is '#FFF569', but not great on white...
            'Shaman':       '#0070DE',
            'Warlock':      '#9482C9',
            'Warrior':      '#C79C6E',
        };

        var DEFAULT_CLASS_COLOR = '#808080';

        var QUALITY_COLORS = {
            'Common':    '#E0E0E0',
            'Uncommon':  '#1EFF00',
            'Rare':      '#0070FF',
            'Epic':      '#A335EE',
            'Legendary': '#FF8000',
            'Heirloom':  '#E6CC80',
        };

        var DEFAULT_QUALITY_COLOR = '#9D9D9D';


        function getClassColor(name)
        {
            if (CLASS_COLORS[name] !== undefined)
                return CLASS_COLORS[name];

            return DEFAULT_CLASS_COLOR;
        }


        function getQualityColor(name)
        {
            if (QUALITY_COLORS[name] !== undefined)
                return QUALITY_COLORS[name];

            return DEFAULT_QUALITY_COLOR;
        }


        function processEquipmentOverview(data, table_id)
        {
            var parent = $('#' + table_id + ' tbody')[0];

            for (var i = 0; i < data.characters.length; ++i)
            {
                var character = data.characters[i];

                for (var j = 0; j < character.specs.length; ++j)
                {
                    var spec = character.specs[j];

                    if (spec.ilvl == null)
                        continue;

                    var tr = document.createElement('tr');
                    parent.appendChild(tr);

                    // Name
                    var td = document.createElement('td');
                    tr.appendChild(td);

                    var a = document.createElement('a');
                    a.href = character.armory_url;
                    a.textContent = character.name;
                    a.style.color = getClassColor(character.class);
                    td.appendChild(a);

                    // Role
                    td = document.createElement('td');
                    td.className = 'role';
                    tr.appendChild(td);

                    img = document.createElement('img');
                    img.src = spec.icon;
                    td.appendChild(img);

                    span = document.createElement('span');
                    span.textContent = spec.role;
                    td.appendChild(span);

                    // iLevel
                    td = document.createElement('td');
                    td.className = 'centered';
                    tr.appendChild(td);

                    span = document.createElement('span');
                    span.className = 'progressbar';
                    $(span).html('&nbsp;');

                    if (spec.ilvl >= 450)
                    {
                        if (spec.ilvl < 600)
                        {
                            span.style.width = '' + (spec.ilvl - 450) * 2 + 'px';
                        }
                        else
                        {
                            span.style.width = '300px';
                            span.className += ' full';
                        }

                        if (spec.ilvl < 500)
                            span.className += ' common';
                        else if (spec.ilvl < 510)
                            span.className += ' uncommon';
                        else if (spec.ilvl < 520)
                            span.className += ' rare';
                        else if (spec.ilvl < 530)
                            span.className += ' epic';
                        else
                            span.className += ' legendary';
                    }
                    else
                    {
                        span.style.width = '0px';
                    }

                    td.appendChild(span);

                    span = document.createElement('span');
                    span.className = 'progressbar_background';
                    $(span).html('&nbsp;');

                    if (spec.ilvl >= 450)
                    {
                        span.style.width = '' + (600 - spec.ilvl) * 2 + 'px';
                    }
                    else
                    {
                        span.style.width = '300px';
                        span.className += ' full';
                    }

                    td.appendChild(span);

                    span = document.createElement('span');
                    span.textContent = spec.ilvl;
                    td.appendChild(span);
                }
            }

            $('#' + table_id + '-progress').hide();
            $('#' + table_id).show();
        }


        function processEquipment(data, table_id)
        {
            function _processSlot(slot, character, spec)
            {
                var row = $('#' + table_id + ' tr[name=' + slot + ']')[0];

                var td = document.createElement('td');
                row.appendChild(td);

                if (spec.items[slot] !== null)
                {
                    var span = document.createElement('span');
                    span.className = 'level';
                    span.textContent = '(' + spec.items[slot].level + ')';
                    td.appendChild(span);

                    if (spec.items[slot].level < spec.ilvl - 10)
                        span.className += ' below';
                    else if (spec.items[slot].level > spec.ilvl + 10)
                        span.className += ' above';

                    if (spec.items[slot].upgrade &&
                        (spec.items[slot].upgrade['current'] < spec.items[slot].upgrade['total']))
                    {
                        var img = document.createElement('img');
                        img.className = 'upgrade';
                        img.src = 'images/up-circular-16.png';
                        td.appendChild(img);
                    }
                    else
                    {
                        span.className += ' no-upgrade';
                    }

                    var img = document.createElement('img');
                    img.src = spec.items[slot].icon;
                    td.appendChild(img);

                    var a = document.createElement('a');
                    a.href = 'http://' + data.locale + '.wowhead.com/item=' + spec.items[slot].id;
                    a.textContent = spec.items[slot].name;
                    a.style.color = getQualityColor(spec.items[slot].quality);
                    td.appendChild(a);

                    a.rel = 'item=' + spec.items[slot].id;

                    if (spec.items[slot].quality == 'Heirloom')
                        a.rel += '&amp;lvl=' + character.level;

                    if (spec.items[slot].upgrade)
                        a.rel += '&amp;upgd=' + spec.items[slot].upgrade['current'];

                    if (spec.items[slot].random_enchant)
                        a.rel += '&amp;rand=' + spec.items[slot].random_enchant;

                    if (spec.items[slot].enchant)
                        a.rel += '&amp;ench=' + spec.items[slot].enchant;

                    if (spec.items[slot].gems && (spec.items[slot].gems.length > 0))
                    {
                        a.rel += '&amp;gems=' + spec.items[slot].gems[0];
                        for (var i = 1; i < spec.items[slot].gems.length; ++i)
                            a.rel += ':' + spec.items[slot].gems[i];
                    }

                    if (spec.items[slot].extra_socket)
                        a.rel += '&amp;sock';

                    if (spec.items[slot].reforge)
                        a.rel += '&amp;forg=' + spec.items[slot].reforge;

                    if (spec.items[slot].set && (spec.items[slot].set.length > 0))
                    {
                        a.rel += '&amp;pcs=' + spec.items[slot].set[0];
                        for (var i = 1; i < spec.items[slot].set.length; ++i)
                            a.rel += ':' + spec.items[slot].set[i];
                    }
                }
                else
                {
                    td.textContent = '-';
                }
            }


            var header_row = $('#' + table_id + ' tr[name=characters]')[0];

            for (var i = 0; i < data.characters.length; ++i)
            {
                var character = data.characters[i];

                for (var j = 0; j < character.specs.length; ++j)
                {
                    var spec = character.specs[j];

                    if (spec.ilvl == null)
                        continue;

                    var th = document.createElement('th');
                    header_row.appendChild(th);

                    var a = document.createElement('a');
                    a.href = character.armory_url;
                    a.textContent = character.name;
                    a.style.color = getClassColor(character.class);
                    th.appendChild(a);

                    img = document.createElement('img');
                    img.src = spec.icon;
                    th.appendChild(img);

                    span = document.createElement('span');
                    span.textContent = spec.role;
                    th.appendChild(span);

                    _processSlot('main_hand', character, spec);
                    _processSlot('off_hand', character, spec);
                    _processSlot('head', character, spec);
                    _processSlot('neck', character, spec);
                    _processSlot('shoulder', character, spec);
                    _processSlot('back', character, spec);
                    _processSlot('chest', character, spec);
                    _processSlot('wrist', character, spec);
                    _processSlot('hands', character, spec);
                    _processSlot('waist', character, spec);
                    _processSlot('legs', character, spec);
                    _processSlot('feet', character, spec);
                    _processSlot('finger1', character, spec);
                    _processSlot('finger2', character, spec);
                    _processSlot('trinket1', character, spec);
                    _processSlot('trinket2', character, spec);
                }
            }

            $('#' + table_id + '-progress').hide();
            $('#' + table_id).show();
        }


        function processModifications(data, table_id)
        {
            function _processSlot(slot, spec)
            {
                var row = $('#' + table_id + ' tr[name=' + slot + ']')[0];

                var td = document.createElement('td');
                row.appendChild(td);

                if (spec.valid_modifications)
                {
                    if (spec.modifications[slot])
                    {
                        var ul = document.createElement('ul');
                        td.appendChild(ul);

                        if (spec.modifications[slot].gems !== null)
                        {
                            for (var i = 0; i < spec.modifications[slot].gems.length; ++i)
                            {
                                if (spec.modifications[slot].gems[i])
                                {
                                    var li = document.createElement('li');
                                    li.className = 'gem';
                                    ul.appendChild(li);

                                    var gem = data.items['' + spec.modifications[slot].gems[i]];
                                    if (gem)
                                    {
                                        var img = document.createElement('img');
                                        img.src = "http://eu.media.blizzard.com/wow/icons/18/" + gem.icon + '.jpg';
                                        li.appendChild(img);
                                
                                        var a = document.createElement('a');
                                        a.href = 'http://' + data.locale + '.wowhead.com/item=' + gem.id;
                                        a.textContent = gem.name;
                                        a.style.color = getQualityColor(Object.keys(QUALITY_COLORS)[gem.quality - 1]);
                                        li.appendChild(a);
                                    }
                                    else
                                    {
                                        li.textContent = 'Unknown (' + spec.modifications[slot].gems[i] + ')';
                                    }
                                }
                            }
                        }

                        if (spec.modifications[slot].enchant !== null)
                        {
                            var li = document.createElement('li');
                            li.className = 'enchant';
                            li.textContent = spec.modifications[slot].enchant;
                            ul.appendChild(li);
                        }

                        if (spec.modifications[slot].reforge !== null)
                        {
                            var li = document.createElement('li');
                            li.className = 'reforge';
                            li.textContent = spec.modifications[slot].reforge;
                            ul.appendChild(li);
                        }
                    }
                }
                else
                {
                    td.style.backgroundColor = '#777777';
                }
            }


            var header_row = $('#' + table_id + ' tr[name=characters]')[0];

            for (var i = 0; i < data.characters.length; ++i)
            {
                var character = data.characters[i];

                for (var j = 0; j < character.specs.length; ++j)
                {
                    var spec = character.specs[j];

                    if (spec.ilvl == null)
                        continue;

                    var th = document.createElement('th');
                    header_row.appendChild(th);

                    var a = document.createElement('a');
                    a.href = character.armory_url;
                    a.textContent = character.name;
                    a.style.color = getClassColor(character.class);
                    th.appendChild(a);

                    img = document.createElement('img');
                    img.src = spec.icon;
                    th.appendChild(img);

                    span = document.createElement('span');
                    span.textContent = spec.role;
                    th.appendChild(span);

                    if (spec.amr_import_string)
                    {
                        var img = document.createElement('img');
                        img.className = 'download';
                        img.src = 'images/download.png';
                        img.title = 'Display the AMR import string';
                        img.amr_import_string = spec.amr_import_string;
                        th.appendChild(img);

                        $(img).click(function(event)
                            {
                                alert(event.target.amr_import_string);
                            });
                    }

                    _processSlot('main_hand', spec);
                    _processSlot('off_hand', spec);
                    _processSlot('head', spec);
                    _processSlot('neck', spec);
                    _processSlot('shoulder', spec);
                    _processSlot('back', spec);
                    _processSlot('chest', spec);
                    _processSlot('wrist', spec);
                    _processSlot('hands', spec);
                    _processSlot('waist', spec);
                    _processSlot('legs', spec);
                    _processSlot('feet', spec);
                    _processSlot('finger1', spec);
                    _processSlot('finger2', spec);
                    _processSlot('trinket1', spec);
                    _processSlot('trinket2', spec);
                }
            }

            $('#' + table_id + '-progress').hide();
            $('#' + table_id).show();
        }


        function processRaidUpdates(data, table_id)
        {
            function _nb_upgrades(loot_table, spec)
            {
                var nb_upgrades = 0;

                for (var i = 0; i < loot_table.length; ++i)
                {
                    if (loot_table[i].spec == spec)
                        ++nb_upgrades;
                }

                return nb_upgrades;
            }


            function _process_slot(slot, loot_table, spec)
            {
                var row = $('#' + table_id + '-details tr[name=' + slot + ']')[0];

                var td = document.createElement('td');
                row.appendChild(td);

                var ul = document.createElement('ul');
                td.appendChild(ul);

                var count = 0;

                for (var i = 0; i < loot_table.length; ++i)
                {
                    if ((loot_table[i].spec == spec.name) && (loot_table[i].slot == slot))
                    {
                        var li = document.createElement('li');
                        ul.appendChild(li);

                        if ((slot != 'consumable') && (spec.items[slot] != null))
                        {
                            var span = document.createElement('span');
                            span.className = 'level';
                            span.textContent = '(+' + (loot_table[i].level - spec.items[slot].level) + ')';
                            li.appendChild(span);
                        }

                        var a = document.createElement('a');
                        a.href = 'http://' + data.locale + '.wowhead.com/item=' + loot_table[i].id;
                        a.textContent = loot_table[i].name;
                        a.style.color = getQualityColor('Epic');
                        li.appendChild(a);

                        ++count;
                    }
                }

                return count;
            }


            function _add_cell(row, nb, raid, mode, spec, character_name)
            {
                var td = document.createElement('td');
                td.className = 'count';
                row.appendChild(td);

                var a = document.createElement('a');
                a.href = '#';
                a.textContent = '' + nb;
                td.appendChild(a);

                $(a).click(function()
                {
                    var header_row = $('#' + table_id + '-details thead tr')[0];

                    var th_to_remove = $('#' + table_id + '-details th');
                    for (var i = 1; i < th_to_remove.length; ++i)
                        header_row.removeChild(th_to_remove[i]);

                    var td_to_remove = $('#' + table_id + '-details td');
                    for (var i = 0; i < td_to_remove.length; ++i)
                    {
                        if (td_to_remove[i].className != 'slot')
                            td_to_remove[i].parentNode.removeChild(td_to_remove[i]);
                    }

                    $('#' + table_id + '-details tbody tr').hide();

                    var counters = {
                        main_hand:  0,
                        off_hand:   0,
                        head:       0,
                        neck:       0,
                        shoulder:   0,
                        back:       0,
                        chest:      0,
                        wrist:      0,
                        hands:      0,
                        waist:      0,
                        legs:       0,
                        feet:       0,
                        finger1:    0,
                        finger2:    0,
                        trinket1:   0,
                        trinket2:   0,
                        consumable: 0,
                    };

                    for (var i = 0; i < raid.boss.length; ++i)
                    {
                        var boss = raid.boss[i];

                        var th = document.createElement('th');
                        th.textContent = boss.name;
                        header_row.appendChild(th);

                        counters.main_hand  += _process_slot('main_hand', boss.loot_tables[mode], spec);
                        counters.off_hand   += _process_slot('off_hand', boss.loot_tables[mode], spec);
                        counters.head       += _process_slot('head', boss.loot_tables[mode], spec);
                        counters.neck       += _process_slot('neck', boss.loot_tables[mode], spec);
                        counters.shoulder   += _process_slot('shoulder', boss.loot_tables[mode], spec);
                        counters.back       += _process_slot('back', boss.loot_tables[mode], spec);
                        counters.chest      += _process_slot('chest', boss.loot_tables[mode], spec);
                        counters.wrist      += _process_slot('wrist', boss.loot_tables[mode], spec);
                        counters.hands      += _process_slot('hands', boss.loot_tables[mode], spec);
                        counters.waist      += _process_slot('waist', boss.loot_tables[mode], spec);
                        counters.legs       += _process_slot('legs', boss.loot_tables[mode], spec);
                        counters.feet       += _process_slot('feet', boss.loot_tables[mode], spec);
                        counters.finger1    += _process_slot('finger1', boss.loot_tables[mode], spec);
                        counters.finger2    += _process_slot('finger2', boss.loot_tables[mode], spec);
                        counters.trinket1   += _process_slot('trinket1', boss.loot_tables[mode], spec);
                        counters.trinket2   += _process_slot('trinket2', boss.loot_tables[mode], spec);
                        counters.consumable += _process_slot('consumable', boss.loot_tables[mode], spec);
                    }

                    var slot_names = Object.keys(counters);
                    for (var i = 0; i < slot_names.length; ++i)
                    {
                        if (counters[slot_names[i]] > 0)
                            $('#' + table_id + '-details tbody tr[name=' + slot_names[i] + ']').show();
                    }

                    $('#' + table_id + '-details').show();

                    $('#' + table_id + '-details-title').text('Raid updates - ' + character_name + ' - ' + spec.name + ' - ' + mode);
                    $('#' + table_id + '-details-title').show();

                    return false;
                });
            }


            if (data.raids == null)
            {
                $('#' + table_id + '-container').hide();
                return;
            }

            var thead = $('#' + table_id + ' thead')[0];
            var tbody = $('#' + table_id + ' tbody')[0];

            var tr1 = document.createElement('tr');
            tr1.className = 'no-highlight';
            thead.appendChild(tr1);

            var tr2 = document.createElement('tr');
            tr2.className = 'no-highlight';
            thead.appendChild(tr2);

            var th = document.createElement('th');
            th.className = 'character';
            tr1.appendChild(th);

            th = document.createElement('th');
            th.className = 'character';
            tr2.appendChild(th);

            for (var i = 0; i < data.raids.length; ++i)
            {
                var th = document.createElement('th');
                th.textContent = data.raids[i];
                th.colSpan = 4;
                tr1.appendChild(th);

                th = document.createElement('th');
                th.textContent = 'LFR';
                tr2.appendChild(th);

                th = document.createElement('th');
                th.textContent = 'Flex';
                tr2.appendChild(th);

                th = document.createElement('th');
                th.textContent = 'Normal';
                tr2.appendChild(th);

                th = document.createElement('th');
                th.textContent = 'Heroic';
                tr2.appendChild(th);
            }

            for (var i = 0; i < data.characters.length; ++i)
            {
                var character = data.characters[i];

                for (var j = 0; j < character.specs.length; ++j)
                {
                    var spec = character.specs[j];

                    if (spec.ilvl == null)
                        continue;

                    var tr = document.createElement('tr');
                    tbody.appendChild(tr);

                    var td = document.createElement('td');
                    tr.appendChild(td);

                    var a = document.createElement('a');
                    a.href = character.armory_url;
                    a.textContent = character.name;
                    a.style.color = getClassColor(character.class);
                    td.appendChild(a);

                    img = document.createElement('img');
                    img.src = spec.icon;
                    td.appendChild(img);

                    span = document.createElement('span');
                    span.textContent = spec.role;
                    td.appendChild(span);

                    for (var k = 0; k < data['raids'].length; ++k)
                    {
                        for (var l = 0; l < character.raid_upgrades.length; ++l)
                        {
                            var upgrade = character.raid_upgrades[l];
                            if (upgrade.raid != data.raids[k])
                                continue;

                            var nb_lfr = 0;
                            var nb_flex = 0;
                            var nb_normal = 0;
                            var nb_heroic = 0;

                            for (var m = 0; m < upgrade.boss.length; ++m)
                            {
                                var boss = upgrade.boss[m];

                                nb_lfr    += _nb_upgrades(boss.loot_tables.lfr, spec.name);
                                nb_flex   += _nb_upgrades(boss.loot_tables.flex, spec.name);
                                nb_normal += _nb_upgrades(boss.loot_tables.normal, spec.name);
                                nb_heroic += _nb_upgrades(boss.loot_tables.heroic, spec.name);
                            }

                            _add_cell(tr, nb_lfr, upgrade, 'lfr', spec, character.name);
                            _add_cell(tr, nb_flex, upgrade, 'flex', spec, character.name);
                            _add_cell(tr, nb_normal, upgrade, 'normal', spec, character.name);
                            _add_cell(tr, nb_heroic, upgrade, 'heroic', spec, character.name);

                            break;
                        }
                    }
                }
            }

            $('#' + table_id + '-progress').hide();
            $('#' + table_id).show();
        }

        </script>
</head>
<body>

    <a href="https://github.com/Kanma/WoWCharactersViewer">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub" />
    </a>


    <h1>Characters</h1>

    <img id="characters-progress" src="images/progress.gif" />

    <table id="characters" cellspacing="0" cellpadding="0" style="display: none;">
        <thead>
            <tr class="no-highlight">
                <th>Name</th>
                <th>Role</th>
                <th>iLevel</th>
            </td>
        </thead>
        <tbody>
        </tbody>
    </table>


    <h1>Equipment</h1>

    <img id="equipment-progress" src="images/progress.gif" />

    <table id="equipment" class="equipment" cellspacing="0" cellpadding="0" style="display: none;">
        <thead>
            <tr name="characters" class="no-highlight">
                <th class="slot"></th>
            </tr>
        </thead>
        <tbody>
            <tr name="main_hand">
                <td class="slot">Main hand</td>
            </tr>
            <tr name="off_hand">
                <td class="slot">Off hand</td>
            </tr>
            <tr name="head">
                <td class="slot">Head</td>
            </tr>
            <tr name="neck">
                <td class="slot">Neck</td>
            </tr>
            <tr name="shoulder">
                <td class="slot">Shoulder</td>
            </tr>
            <tr name="back">
                <td class="slot">Back</td>
            </tr>
            <tr name="chest">
                <td class="slot">Chest</td>
            </tr>
            <tr name="wrist">
                <td class="slot">Wrist</td>
            </tr>
            <tr name="hands">
                <td class="slot">Hands</td>
            </tr>
            <tr name="waist">
                <td class="slot">Waist</td>
            </tr>
            <tr name="legs">
                <td class="slot">Legs</td>
            </tr>
            <tr name="feet">
                <td class="slot">Feet</td>
            </tr>
            <tr name="finger1">
                <td class="slot">Finger 1</td>
            </tr>
            <tr name="finger2">
                <td class="slot">Finger 2</td>
            </tr>
            <tr name="trinket1">
                <td class="slot">Trinket 1</td>
            </tr>
            <tr name="trinket2">
                <td class="slot">Trinket 2</td>
            </tr>
        </tbody>
    </table>


    <h1>Modifications</h1>

    <img id="modifications-progress" src="images/progress.gif" />

    <table id="modifications" class="modifications" cellspacing="0" cellpadding="0" style="display: none;">
        <thead>
            <tr name="characters" class="no-highlight">
                <th class="slot"></th>
            </tr>
        </thead>
        <tbody>
            <tr name="main_hand">
                <td class="slot">Main hand</td>
            </tr>
            <tr name="off_hand">
                <td class="slot">Off hand</td>
            </tr>
            <tr name="head">
                <td class="slot">Head</td>
            </tr>
            <tr name="neck">
                <td class="slot">Neck</td>
            </tr>
            <tr name="shoulder">
                <td class="slot">Shoulder</td>
            </tr>
            <tr name="back">
                <td class="slot">Back</td>
            </tr>
            <tr name="chest">
                <td class="slot">Chest</td>
            </tr>
            <tr name="wrist">
                <td class="slot">Wrist</td>
            </tr>
            <tr name="hands">
                <td class="slot">Hands</td>
            </tr>
            <tr name="waist">
                <td class="slot">Waist</td>
            </tr>
            <tr name="legs">
                <td class="slot">Legs</td>
            </tr>
            <tr name="feet">
                <td class="slot">Feet</td>
            </tr>
            <tr name="finger1">
                <td class="slot">Finger 1</td>
            </tr>
            <tr name="finger2">
                <td class="slot">Finger 2</td>
            </tr>
            <tr name="trinket1">
                <td class="slot">Trinket 1</td>
            </tr>
            <tr name="trinket2">
                <td class="slot">Trinket 2</td>
            </tr>
        </tbody>
    </table>


    <div id="raid-updates-container">
        <h1>Raid updates</h1>

        <img id="raid-updates-progress" src="images/progress.gif" />

        <table id="raid-updates" class="raid-updates" cellspacing="0" cellpadding="0" style="display: none;">
            <thead>
            </thead>
            <tbody>
            </tbody>
        </table>

        <h1 id="raid-updates-details-title" style="display: none;">Raid updates - &lt;character&gt; - &lt;mode&gt;</h1>

        <table id="raid-updates-details" class="raid-updates-details" cellspacing="0" cellpadding="0" style="display: none;">
            <thead>
                <tr name="boss" class="no-highlight">
                    <th class="slot"></th>
                </tr>
            </thead>
            <tbody>
                <tr name="main_hand">
                    <td class="slot">Main hand</td>
                </tr>
                <tr name="off_hand">
                    <td class="slot">Off hand</td>
                </tr>
                <tr name="head">
                    <td class="slot">Head</td>
                </tr>
                <tr name="neck">
                    <td class="slot">Neck</td>
                </tr>
                <tr name="shoulder">
                    <td class="slot">Shoulder</td>
                </tr>
                <tr name="back">
                    <td class="slot">Back</td>
                </tr>
                <tr name="chest">
                    <td class="slot">Chest</td>
                </tr>
                <tr name="wrist">
                    <td class="slot">Wrist</td>
                </tr>
                <tr name="hands">
                    <td class="slot">Hands</td>
                </tr>
                <tr name="waist">
                    <td class="slot">Waist</td>
                </tr>
                <tr name="legs">
                    <td class="slot">Legs</td>
                </tr>
                <tr name="feet">
                    <td class="slot">Feet</td>
                </tr>
                <tr name="finger1">
                    <td class="slot">Finger 1</td>
                </tr>
                <tr name="finger2">
                    <td class="slot">Finger 2</td>
                </tr>
                <tr name="trinket1">
                    <td class="slot">Trinket 1</td>
                </tr>
                <tr name="trinket2">
                    <td class="slot">Trinket 2</td>
                </tr>
                <tr name="consumable">
                    <td class="slot">Token</td>
                </tr>
            </tbody>
        </table>
    </div>


    <script type="text/javascript">
        window.onload = function ()
        {
            $.get('data.json?r=' + Math.random(), function(data) {
                // By security, in case the server doesn't return the correct mime type
                if (typeof(data) == "string")
                    data = JSON.parse(data);

                processEquipmentOverview(data, 'characters');
                processEquipment(data, 'equipment');
                processModifications(data, 'modifications');
                processRaidUpdates(data, 'raid-updates');
            });
        }
    </script>
</html>
